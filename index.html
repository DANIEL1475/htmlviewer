<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Loader</title>
  <style>
    body {font-family: sans-serif; padding: 2rem;}
    iframe {width: 100%; height: 90vh; border: none;}
  </style>
</head>
<body>
  <h2>Loading ...</h2>
  <iframe id="viewer"></iframe>

  <script>
    const params = new URLSearchParams(window.location.search);
    const fileUrl = params.get('file');

    if (fileUrl) {
      document.querySelector('h2').textContent = 'Showing file: ' + fileUrl;

      fetch(fileUrl)
        .then(r => r.json())
        .then(data => {
          const the_content = data.contents;

          const blob = new Blob([the_content], { type: 'text/html' });
          const blobUrl = URL.createObjectURL(blob);
          document.getElementById('viewer').src = blobUrl;
        })
        .catch(err => {
          console.error(err);
          document.querySelector('h2').textContent = 'Error loading content';
        });

    } else {
      document.querySelector('h2').textContent = 'Set ?file= parameter';
    }
  </script>
</body>
</html>
