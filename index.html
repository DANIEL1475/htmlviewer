<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Loader</title>
  <style>
    body {margin: 2px;}
    iframe {width: 100%; height: 90vh; border: none;}
    h5 {margin: 2px;}
  </style>
</head>
<body>
  <h5>Loading ...</h5>
  <iframe id="viewer"></iframe>

  <script>
    const params = new URLSearchParams(window.location.search);
    const fileUrl = params.get('file');

    if (fileUrl) {
      document.querySelector('h5').textContent = 'Showing file: ' + fileUrl;

      fetch("https://api.allorigins.win/get?url="+fileUrl)
        .then(r => r.json())
        .then(data => {
          const the_content = data.contents;

          const blob = new Blob([the_content], { type: 'text/html' });
          const blobUrl = URL.createObjectURL(blob);
          document.getElementById('viewer').src = blobUrl;
        })
        .catch(err => {
          console.error(err);
          document.querySelector('h5').textContent = 'Error loading content';
        });

    } else {
      document.querySelector('h5').textContent = 'Set ?file= parameter';
    }
  </script>
</body>
</html>
